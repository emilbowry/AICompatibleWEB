{"version":3,"file":"605.bundle.js","mappings":"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","sources":["webpack://simpleapp/./src/pages/dpo-tool/CSS_Markdown/mardown-viewer/MarkDownViewer.tsx","webpack://simpleapp/./src/pages/dpo-tool/CSS_Markdown/CSSMarkdown.styles.ts","webpack://simpleapp/./src/pages/dpo-tool/CSS_Markdown/mardown-viewer/DataUtils.ts","webpack://simpleapp/./src/pages/dpo-tool/CSS_Markdown/CSSMarkdown.tsx","webpack://simpleapp/./src/pages/dpo-tool/tool.tsx"],"sourcesContent":["import React from \"react\";\nimport ReactMarkdown, { Components } from \"react-markdown\";\nimport { visit } from \"unist-util-visit\";\nimport remarkGfm from \"remark-gfm\";\nimport { IHighlightNode, IFlatSegment, ITextNode } from \"../CSSMarkdown.types\";\n\nconst toCssClass = (id: string) => {\n\treturn `hl-${id.replace(/[^a-zA-Z0-9]/g, \"_\")}`;\n};\nconst remarkHighlightPlugin = (options: { segments: IFlatSegment[] }) => {\n\treturn (tree: any) => {\n\t\tconst { segments } = options;\n\t\tif (!segments.length) return;\n\n\t\tvisit(tree, \"text\", (node: any, index, parent) => {\n\t\t\tif (!parent || index === undefined) return;\n\t\t\tif (!node.position) return;\n\n\t\t\tconst textNode = node as ITextNode;\n\t\t\tconst nodeStart = node.position.start.offset;\n\t\t\tconst nodeEnd = node.position.end.offset;\n\n\t\t\tconst relevantSegments = segments.filter(\n\t\t\t\t(s) => s.start < nodeEnd && s.end > nodeStart\n\t\t\t);\n\n\t\t\tif (relevantSegments.length === 0) return;\n\n\t\t\tconst newChildren: (ITextNode | IHighlightNode)[] = [];\n\t\t\tlet cursor = nodeStart;\n\n\t\t\trelevantSegments.sort((a, b) => a.start - b.start);\n\n\t\t\tfor (const seg of relevantSegments) {\n\t\t\t\tif (cursor < seg.start) {\n\t\t\t\t\tnewChildren.push({\n\t\t\t\t\t\ttype: \"text\",\n\t\t\t\t\t\tvalue: textNode.value.slice(\n\t\t\t\t\t\t\tcursor - nodeStart,\n\t\t\t\t\t\t\tseg.start - nodeStart\n\t\t\t\t\t\t),\n\t\t\t\t\t});\n\t\t\t\t\tcursor = seg.start;\n\t\t\t\t}\n\n\t\t\t\tconst hStart = Math.max(cursor, seg.start);\n\t\t\t\tconst hEnd = Math.min(nodeEnd, seg.end);\n\n\t\t\t\tif (hStart < hEnd) {\n\t\t\t\t\tconst textContent = textNode.value.slice(\n\t\t\t\t\t\thStart - nodeStart,\n\t\t\t\t\t\thEnd - nodeStart\n\t\t\t\t\t);\n\n\t\t\t\t\t// Safe CSS Class Generation\n\t\t\t\t\tconst classNames = seg.ids\n\t\t\t\t\t\t.map((id) => toCssClass(id))\n\t\t\t\t\t\t.join(\" \");\n\n\t\t\t\t\tnewChildren.push({\n\t\t\t\t\t\ttype: \"highlight\",\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\thName: \"span\",\n\t\t\t\t\t\t\thProperties: { className: classNames },\n\t\t\t\t\t\t},\n\t\t\t\t\t\tchildren: [{ type: \"text\", value: textContent }],\n\t\t\t\t\t});\n\n\t\t\t\t\tcursor = hEnd;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (cursor < nodeEnd) {\n\t\t\t\tnewChildren.push({\n\t\t\t\t\ttype: \"text\",\n\t\t\t\t\tvalue: textNode.value.slice(cursor - nodeStart),\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tparent.children.splice(index, 1, ...newChildren);\n\t\t\treturn index + newChildren.length;\n\t\t});\n\t};\n};\nconst MarkdownViewer = React.memo(\n\t({ content, segments }: { content: string; segments: IFlatSegment[] }) => {\n\t\treturn (\n\t\t\t<ReactMarkdown\n\t\t\t\tremarkPlugins={[\n\t\t\t\t\t[remarkHighlightPlugin, { segments }],\n\t\t\t\t\tremarkGfm,\n\t\t\t\t]}\n\t\t\t\tcomponents={\n\t\t\t\t\t{\n\t\t\t\t\t\thighlight: ({ node, ...props }: any) => (\n\t\t\t\t\t\t\t<span {...props} />\n\t\t\t\t\t\t),\n\t\t\t\t\t} as Components\n\t\t\t\t}\n\t\t\t>\n\t\t\t\t{content}\n\t\t\t</ReactMarkdown>\n\t\t);\n\t}\n);\n\nexport { MarkdownViewer, toCssClass };\n","// client/src/pages/dpo-tool/CSS_Markdown/CSSMarkdown.styles.ts\n\nimport { THighlightId, THighlightRules } from \"./CSSMarkdown.types\";\n\nimport { toCssClass } from \"./mardown-viewer/MarkDownViewer\";\nconst MainContainerStyle: React.CSSProperties = {\n\tdisplay: \"flex\",\n\tflexDirection: \"column\",\n\tfontFamily: \"sans-serif\",\n\twidth: \"100%\",\n\tmaxWidth: \"1200px\",\n\tmargin: \"20px auto\",\n\theight: \"100%\",\n\tborder: \"1px solid #ccc\",\n\tborderRadius: \"8px\",\n\toverflow: \"hidden\",\n\tbackgroundColor: \"#fff\",\n};\nconst TopControlBarStyle: React.CSSProperties = {\n\tpadding: \"15px\",\n\tbackgroundColor: \"#f3f4f6\",\n\tborderBottom: \"1px solid #e5e7eb\",\n\tdisplay: \"flex\",\n\talignItems: \"center\",\n\tgap: \"15px\",\n\tzIndex: 10,\n};\n\nconst ContentAreaStyle: React.CSSProperties = {\n\tdisplay: \"flex\",\n\t// flexDirection: \"row\",\n\t// flex: 1,\n\toverflow: \"hidden\",\n\theight: \"70vh\",\n};\n\nconst SidebarStyle: React.CSSProperties = {\n\twidth: \"280px\",\n\tminWidth: \"280px\",\n\tbackgroundColor: \"#f9fafb\",\n\tborderRight: \"1px solid #ccc\",\n\tpadding: \"20px\",\n\toverflowY: \"auto\",\n\tdisplay: \"flex\",\n\tflexDirection: \"column\",\n\tgap: \"20px\",\n};\n\nconst MainContentColumnStyle: React.CSSProperties = {\n\tflex: 1,\n\tdisplay: \"flex\",\n\tflexDirection: \"column\",\n\toverflow: \"hidden\",\n};\n\nconst DocGridContainerStyle: React.CSSProperties = {\n\tflex: 1,\n\tdisplay: \"flex\",\n\tflexDirection: \"row\",\n\tbackgroundColor: \"#fff\",\n\toverflow: \"hidden\",\n};\n\nconst SharedFooterStyle: React.CSSProperties = {\n\tpadding: \"15px\",\n\tbackgroundColor: \"#fff\",\n\tborderTop: \"1px solid #eee\",\n\t// display: \"flex\",\n\t// flexDirection: \"column\",\n\toverflow: \"hidden\",\n\n\theight: \"20vh\",\n\twidth: \"100%\",\n\tgap: \"8px\",\n};\n\nconst SectionHeaderStyle: React.CSSProperties = {\n\tfontSize: \"11px\",\n\ttextTransform: \"uppercase\",\n\tcolor: \"#6b7280\",\n\tfontWeight: \"800\",\n\tmarginBottom: \"10px\",\n\tletterSpacing: \"0.05em\",\n};\n\nconst ButtonStyle: React.CSSProperties = {\n\tpadding: \"8px 12px\",\n\tborder: \"1px solid transparent\",\n\tborderRadius: \"6px\",\n\tcursor: \"pointer\",\n\ttextAlign: \"left\",\n\tfontSize: \"13px\",\n\tlineHeight: \"1.4\",\n\ttransition: \"all 0.2s\",\n\twidth: \"100%\",\n\tmarginBottom: \"5px\",\n};\n\nconst DropdownWrapperStyle: React.CSSProperties = {\n\tposition: \"relative\",\n\tdisplay: \"inline-block\",\n};\n\nconst DropdownMenuStyle: React.CSSProperties = {\n\tposition: \"absolute\",\n\ttop: \"100%\",\n\tleft: 0,\n\tmarginTop: \"4px\",\n\tbackgroundColor: \"#fff\",\n\tborder: \"1px solid #ccc\",\n\tborderRadius: \"4px\",\n\tboxShadow: \"0 4px 6px rgba(0,0,0,0.1)\",\n\twidth: \"100%\",\n\tzIndex: 100,\n\tpadding: \"5px 0\",\n};\n\nconst DropdownItemBaseStyle: React.CSSProperties = {\n\tpadding: \"8px 12px\",\n\tdisplay: \"flex\",\n\talignItems: \"center\",\n\tgap: \"8px\",\n\tcursor: \"pointer\",\n\tfontSize: \"14px\",\n\tuserSelect: \"none\",\n};\n\nconst dropdownItemStyle = (isSelected: boolean): React.CSSProperties => ({\n\t...DropdownItemBaseStyle,\n\tbackgroundColor: isSelected ? \"#f3f4f6\" : \"#fff\",\n});\n\nconst SelectorButtonStyle: React.CSSProperties = {\n\tpadding: \"8px 16px\",\n\tbackgroundColor: \"#fff\",\n\tborder: \"1px solid #ccc\",\n\tborderRadius: \"4px\",\n\tcursor: \"pointer\",\n\tfontSize: \"14px\",\n\tdisplay: \"flex\",\n\talignItems: \"center\",\n\tjustifyContent: \"space-between\",\n\tminWidth: \"220px\",\n};\n\nconst ClearButtonStyle: React.CSSProperties = {\n\tmarginLeft: \"auto\",\n\tpadding: \"5px 12px\",\n\tcursor: \"pointer\",\n\tborder: \"1px solid #ccc\",\n\tborderRadius: \"4px\",\n\tbackground: \"#fff\",\n};\n\nconst EmptyStateStyle: React.CSSProperties = {\n\tfontSize: \"12px\",\n\tcolor: \"#ccc\",\n\tmarginBottom: \"10px\",\n};\n\nconst SidebarSectionStyle: React.CSSProperties = {\n\tdisplay: \"flex\",\n\tflexDirection: \"column\",\n\tgap: \"8px\",\n};\n\nconst SharedItemsWrapperStyle: React.CSSProperties = {\n\tdisplay: \"flex\",\n\tflexWrap: \"wrap\",\n\tgap: \"10px\",\n};\n\nconst SharedCategoryButtonStyle: React.CSSProperties = {\n\twidth: \"auto\",\n\tmarginBottom: 0,\n};\n\nconst EmptyGridMessageStyle: React.CSSProperties = {\n\tmargin: \"auto\",\n\tcolor: \"#ccc\",\n};\n\nconst DocColumnWrapperStyle: React.CSSProperties = {\n\tflex: 1,\n\tdisplay: \"flex\",\n\tflexDirection: \"column\",\n\tborderLeft: \"1px solid #eee\",\n\toverflow: \"hidden\",\n\ttransition: \"all 0.3s ease\",\n};\n\nconst getDocHeaderStyle = (color: string): React.CSSProperties => ({\n\tpadding: \"12px\",\n\tborderBottom: \"1px solid #eee\",\n\tbackgroundColor: \"#fff\",\n\tfontWeight: \"bold\",\n\ttextAlign: \"center\",\n\ttextTransform: \"uppercase\",\n\tfontSize: \"12px\",\n\tletterSpacing: \"1px\",\n\tcolor: \"#444\",\n\tborderTop: `4px solid ${color}`,\n});\n\nconst DocScrollStyle: React.CSSProperties = {\n\tflex: 1,\n\tpadding: \"30px\",\n\toverflowY: \"auto\",\n\tfontFamily: \"Georgia, serif\",\n\twhiteSpace: \"pre-wrap\",\n\tlineHeight: \"1.6\",\n\tfontSize: \"14px\",\n};\n\nconst categoryButtonStyle = (\n\tisActive: boolean,\n\tcolor: string,\n\tStyleOverrides: React.CSSProperties = {}\n): React.CSSProperties => {\n\treturn {\n\t\t...ButtonStyle,\n\t\tbackgroundColor: isActive ? color : \"#fff\",\n\t\tborder: isActive ? \"1px solid transparent\" : \"1px solid #d1d5db\",\n\t\tborderLeft: isActive ? \"1px solid transparent\" : `4px solid ${color}`,\n\t\tfontWeight: isActive ? \"bold\" : \"normal\",\n\t\t...StyleOverrides,\n\t};\n};\nconst dynamicHighlightStyles = (\n\tactiveIds: THighlightId[],\n\tcolorMap: Record<string, string>\n): THighlightRules => {\n\tconst rules: THighlightRules = {};\n\n\tactiveIds.forEach((id) => {\n\t\tconst color = colorMap[id] || \"#ddd\";\n\t\tconst borderColor = color.replace(\"0\", \"8\");\n\n\t\tconst safeClassName = `.${toCssClass(id)}`;\n\n\t\t(rules as any)[safeClassName] = {\n\t\t\tbackgroundColor: color,\n\t\t\tborderBottom: `2px solid ${borderColor}`,\n\t\t\tcursor: \"pointer\",\n\t\t\ttransition: \"background-color 0.2s\",\n\t\t\t\"&:hover\": {\n\t\t\t\tfilter: \"brightness(0.95)\",\n\t\t\t},\n\t\t};\n\t});\n\n\treturn rules;\n};\nexport {\n\tDocScrollStyle,\n\tgetDocHeaderStyle,\n\tDocColumnWrapperStyle,\n\tDocGridContainerStyle,\n\tEmptyGridMessageStyle,\n\tEmptyStateStyle,\n\tSharedCategoryButtonStyle,\n\tSharedFooterStyle,\n\tSectionHeaderStyle,\n\tSharedItemsWrapperStyle,\n\tClearButtonStyle,\n\tSelectorButtonStyle,\n\tMainContainerStyle,\n\tTopControlBarStyle,\n\tContentAreaStyle,\n\tSidebarStyle,\n\tMainContentColumnStyle,\n\tButtonStyle,\n\tDropdownWrapperStyle,\n\tDropdownMenuStyle,\n\tSidebarSectionStyle,\n\tdropdownItemStyle,\n\tdynamicHighlightStyles,\n\tcategoryButtonStyle,\n};\n","// --- Data Pre-Processing ---\n// Data Imports\nimport local_question_data from \"./output_q.json\";\nimport local_policy_data from \"./output_p.json\";\n\nimport { useState, useContext, useMemo, createContext } from \"react\";\nimport { generateGradient } from \"../../../../styles\";\nimport {\n\tIRawDocLibrary,\n\tIRawAnalysisData,\n\tTDocId,\n\tIDocMeta,\n\tIFlatSegment,\n\tTHighlightId,\n\tIAnalysisUIState,\n} from \"../CSSMarkdown.types\";\n\nconst RAW_DOCS = local_policy_data as unknown as IRawDocLibrary;\nconst RAW_ANALYSIS = local_question_data as unknown as IRawAnalysisData;\n\n// 1. Flatten Documents for O(1) Lookup and Flat UI List\nconst DOC_LOOKUP: Record<TDocId, IDocMeta> = {};\n\nObject.entries(RAW_DOCS).forEach(([policyName, versions]) => {\n\tObject.entries(versions).forEach(([hash, data]) => {\n\t\t// We format the label here once: \"Privacy Policy (2024-01-01)\"\n\t\tDOC_LOOKUP[hash] = {\n\t\t\tcontent: data.policy_content,\n\t\t\tlabel: `${policyName} (${data.fetch_date})`,\n\t\t};\n\t});\n});\n\n// 2. Color Generation\nconst ANALYSIS_KEYS = Object.keys(RAW_ANALYSIS);\nconst GRADIENT_COLORS = generateGradient(ANALYSIS_KEYS.length);\n\nconst ID_COLORS: Record<string, string> = {};\nANALYSIS_KEYS.forEach((key, index) => {\n\tID_COLORS[key] = GRADIENT_COLORS[index];\n});\n\nconst DOC_HASHES = Object.keys(DOC_LOOKUP);\nconst DOC_COLORS_LIST = generateGradient(\n\tDOC_HASHES.length,\n\t\"#16a34a\", // Green\n\t\"#ea580c\" // Orange\n);\n\nconst DOC_THEME_COLORS: Record<string, string> = {};\nDOC_HASHES.forEach((hash, index) => {\n\tDOC_THEME_COLORS[hash] = DOC_COLORS_LIST[index];\n});\n\n// --- Logic Update: Flatten Ranges (New Structure) ---\n\nconst flattenRanges = (\n\tdocId: TDocId,\n\tdata: IRawAnalysisData\n): IFlatSegment[] => {\n\tconst points = new Set<number>();\n\n\t// Temporary map to hold ranges before segmentation\n\t// [ { id: \"Question A\", start: 10, end: 20 }, ... ]\n\tconst rangeMap: { id: THighlightId; start: number; end: number }[] = [];\n\n\t// Iterate over every question in the analysis\n\tObject.entries(data).forEach(([questionId, docMap]) => {\n\t\t// Direct Access: Check if this question applies to our specific docHash\n\t\tconst occurrences = docMap[docId];\n\n\t\tif (occurrences) {\n\t\t\toccurrences.forEach((instance) => {\n\t\t\t\tconst [start, end] = instance.substring_indices;\n\t\t\t\tpoints.add(start);\n\t\t\t\tpoints.add(end);\n\t\t\t\trangeMap.push({ id: questionId, start, end });\n\t\t\t});\n\t\t}\n\t});\n\n\t// Standard segmentation logic (unchanged)\n\tconst sortedPoints = Array.from(points).sort((a, b) => a - b);\n\tconst segments: IFlatSegment[] = [];\n\n\tfor (let i = 0; i < sortedPoints.length - 1; i++) {\n\t\tconst start = sortedPoints[i];\n\t\tconst end = sortedPoints[i + 1];\n\t\tconst mid = start + (end - start) / 2;\n\n\t\tconst activeIds = rangeMap\n\t\t\t.filter((r) => r.start <= mid && r.end >= mid)\n\t\t\t.map((r) => r.id);\n\n\t\tif (activeIds.length > 0) {\n\t\t\tsegments.push({ start, end, ids: activeIds });\n\t\t}\n\t}\n\n\treturn segments;\n};\n\nconst AnalysisCTX = createContext<IAnalysisUIState>(undefined as any);\n\nconst useAnalysisState = (): IAnalysisUIState => {\n\tconst [activeIds, setActiveIds] = useState<THighlightId[]>([]);\n\tconst [selectedDocs, setSelectedDocs] = useState<TDocId[]>([]);\n\tconst [isDropdownOpen, setIsDropdownOpen] = useState(false);\n\tconst [scrollToId, setScrollToId] = useState<THighlightId | null>(null);\n\n\tconst toggleDoc = (docId: TDocId) => {\n\t\tsetSelectedDocs((prev) =>\n\t\t\tprev.includes(docId)\n\t\t\t\t? prev.filter((d) => d !== docId)\n\t\t\t\t: [...prev, docId]\n\t\t);\n\t};\n\n\tconst toggleId = (id: THighlightId) => {\n\t\tconst isTurningOn = !activeIds.includes(id);\n\n\t\tsetActiveIds((prev) =>\n\t\t\tprev.includes(id) ? prev.filter((x) => x !== id) : [...prev, id]\n\t\t);\n\n\t\tif (isTurningOn) {\n\t\t\tsetScrollToId(id);\n\t\t\tsetTimeout(() => setScrollToId(null), 100);\n\t\t}\n\t};\n\n\treturn {\n\t\tactiveIds,\n\t\tsetActiveIds,\n\t\tselectedDocs,\n\t\tsetSelectedDocs,\n\t\tisDropdownOpen,\n\t\tsetIsDropdownOpen,\n\t\ttoggleDoc,\n\t\ttoggleId,\n\t\tscrollToId,\n\t};\n};\nconst useAnalysisContext = () => {\n\tconst context = useContext(AnalysisCTX);\n\tif (!context) {\n\t\tthrow new Error(\n\t\t\t\"useAnalysisContext must be used within an AnalysisCTX Provider\"\n\t\t);\n\t}\n\treturn context;\n};\n\n// --- Logic Update: Categorization (New Structure) ---\n\nconst useDataCategorization = () => {\n\tconst { selectedDocs } = useAnalysisContext();\n\n\treturn useMemo(() => {\n\t\tconst qTypes: Record<THighlightId, \"unique\" | \"shared\"> = {};\n\n\t\t// A. Determine Global Type using Nested Structure\n\t\tObject.entries(RAW_ANALYSIS).forEach(([questionId, docMap]) => {\n\t\t\tconst uniqueDocsForQuestion = new Set(Object.keys(docMap)); // Keys are hashes\n\t\t\tif (uniqueDocsForQuestion.size > 1) {\n\t\t\t\tqTypes[questionId] = \"shared\";\n\t\t\t} else {\n\t\t\t\tqTypes[questionId] = \"unique\";\n\t\t\t}\n\t\t});\n\n\t\tconst visibleUniqueMap: Record<TDocId, THighlightId[]> = {};\n\t\tconst visibleSharedList: THighlightId[] = [];\n\n\t\tselectedDocs.forEach((docId) => (visibleUniqueMap[docId] = []));\n\n\t\t// B. Filter for Current View\n\t\tObject.entries(RAW_ANALYSIS).forEach(([questionId, docMap]) => {\n\t\t\tconst type = qTypes[questionId];\n\n\t\t\t// Is this question relevant to ANY selected doc?\n\t\t\tconst docKeys = Object.keys(docMap);\n\t\t\tconst isRelevant = docKeys.some((docHash) =>\n\t\t\t\tselectedDocs.includes(docHash)\n\t\t\t);\n\n\t\t\tif (!isRelevant) return;\n\n\t\t\tif (type === \"shared\") {\n\t\t\t\tif (!visibleSharedList.includes(questionId)) {\n\t\t\t\t\tvisibleSharedList.push(questionId);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// It's unique to one doc\n\t\t\t\tconst docId = docKeys[0];\n\t\t\t\tif (visibleUniqueMap[docId]) {\n\t\t\t\t\tvisibleUniqueMap[docId].push(questionId);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn {\n\t\t\tuniqueMap: visibleUniqueMap,\n\t\t\tsharedList: visibleSharedList,\n\t\t};\n\t}, [selectedDocs]);\n};\n\nexport {\n\tuseAnalysisContext,\n\tID_COLORS,\n\tDOC_THEME_COLORS,\n\tuseDataCategorization,\n\tflattenRanges,\n\tRAW_ANALYSIS,\n\tAnalysisCTX,\n\tuseAnalysisState,\n\tDOC_LOOKUP,\n};\n","// client/src/pages/dpo-tool/CSS_Markdown/CSSMarkdown.tsx\n\nimport React, { useEffect, useMemo, useRef } from \"react\";\n\n// --- Types ---\nimport { toCssClass } from \"./mardown-viewer/MarkDownViewer\";\n\nimport {\n\tDocScrollStyle,\n\tgetDocHeaderStyle,\n\tDocColumnWrapperStyle,\n\tDocGridContainerStyle,\n\tEmptyGridMessageStyle,\n\tEmptyStateStyle,\n\tSharedCategoryButtonStyle,\n\tcategoryButtonStyle,\n\tSharedFooterStyle,\n\tSectionHeaderStyle,\n\tSharedItemsWrapperStyle,\n\tClearButtonStyle,\n\tSelectorButtonStyle,\n\tMainContainerStyle,\n\tTopControlBarStyle,\n\tContentAreaStyle,\n\tSidebarStyle,\n\tMainContentColumnStyle,\n\tDropdownWrapperStyle,\n\tDropdownMenuStyle,\n\tSidebarSectionStyle,\n\tdropdownItemStyle,\n\tdynamicHighlightStyles,\n} from \"./CSSMarkdown.styles\";\nimport { styleObjectToString } from \"../../../styles\";\n\nimport {\n\tTDocId,\n\tTHighlightId,\n\tICategoryButtonProps,\n} from \"./CSSMarkdown.types\";\nimport {\n\tuseAnalysisContext,\n\tID_COLORS,\n\tDOC_THEME_COLORS,\n\tuseDataCategorization,\n\tflattenRanges,\n\tRAW_ANALYSIS,\n\tAnalysisCTX,\n\tuseAnalysisState,\n\tDOC_LOOKUP,\n} from \"./mardown-viewer/DataUtils\";\nimport { MarkdownViewer } from \"./mardown-viewer/MarkDownViewer\";\n\n// --- Logic Update: Remark Plugin (Unchanged Logic, just types) ---\n\n// --- Context & Hooks ---\n\nconst useAutoScroll = (containerRef: React.RefObject<HTMLDivElement>) => {\n\tconst { scrollToId } = useAnalysisContext();\n\n\tuseEffect(() => {\n\t\tif (!scrollToId || !containerRef.current) return;\n\n\t\tconst container = containerRef.current;\n\t\tconst target = container.querySelector(\n\t\t\t`.${toCssClass(scrollToId)}`\n\t\t) as HTMLElement;\n\n\t\tif (target) {\n\t\t\tconst containerRect = container.getBoundingClientRect();\n\t\t\tconst targetRect = target.getBoundingClientRect();\n\t\t\tconst relativeTop = targetRect.top - containerRect.top;\n\t\t\tconst currentScroll = container.scrollTop;\n\t\t\tconst centerOffset =\n\t\t\t\tcontainerRect.height / 2 - targetRect.height / 2;\n\t\t\tconst scrollPos = currentScroll + relativeTop - centerOffset;\n\n\t\t\tcontainer.scrollTo({\n\t\t\t\ttop: scrollPos,\n\t\t\t\tbehavior: \"smooth\",\n\t\t\t});\n\t\t}\n\t}, [scrollToId, containerRef]);\n};\n\nconst useDynamicStyles = () => {\n\tconst { activeIds } = useAnalysisContext();\n\n\tconst highlightRules = useMemo(\n\t\t() => dynamicHighlightStyles(activeIds, ID_COLORS),\n\t\t[activeIds]\n\t);\n\n\treturn useMemo(() => styleObjectToString(highlightRules), [highlightRules]);\n};\n\nconst useDropdownBehavior = (\n\tisOpen: boolean,\n\tsetIsOpen: (v: boolean) => void\n) => {\n\tconst ref = useRef<HTMLDivElement>(null);\n\tuseEffect(() => {\n\t\tfunction handleClickOutside(event: MouseEvent) {\n\t\t\tif (\n\t\t\t\tisOpen &&\n\t\t\t\tref.current &&\n\t\t\t\t!ref.current.contains(event.target as Element)\n\t\t\t) {\n\t\t\t\tsetIsOpen(false);\n\t\t\t}\n\t\t}\n\t\tdocument.addEventListener(\"mousedown\", handleClickOutside);\n\t\treturn () =>\n\t\t\tdocument.removeEventListener(\"mousedown\", handleClickOutside);\n\t}, [isOpen, setIsOpen]);\n\n\treturn ref;\n};\n\n// --- Components ---\n\nconst CategoryButton: React.FC<ICategoryButtonProps> = ({\n\tid,\n\tlabelPrefix,\n\tStyleOverrides = {},\n}) => {\n\tconst { activeIds, toggleId } = useAnalysisContext();\n\tconst isActive = activeIds.includes(id);\n\tconst color = ID_COLORS[id] || \"#ccc\";\n\treturn (\n\t\t<button\n\t\t\tonClick={() => toggleId(id)}\n\t\t\tstyle={categoryButtonStyle(isActive, color, StyleOverrides)}\n\t\t>\n\t\t\t{labelPrefix} {id.toUpperCase()}\n\t\t</button>\n\t);\n};\n\nconst SectionHeader: React.FC<{\n\tlabel: string;\n\tcolor?: string;\n\tStyleOverrides?: React.CSSProperties;\n}> = ({ label, color = \"#ccc\", StyleOverrides = {} }) => (\n\t<div\n\t\tstyle={{\n\t\t\t...SectionHeaderStyle,\n\t\t\tborderBottom: `2px solid ${color}`,\n\t\t\tpaddingBottom: \"4px\",\n\t\t\t...StyleOverrides,\n\t\t}}\n\t>\n\t\t{label}\n\t</div>\n);\n\nconst EmptyState: React.FC<{ message?: string }> = ({ message = \"None\" }) => (\n\t<div style={EmptyStateStyle}>{message}</div>\n);\n\n// --- Sub-Components ---\n\nconst AttributeList: React.FC<{\n\tids: THighlightId[];\n\tprefix: string;\n}> = ({ ids, prefix }) =>\n\tids.length === 0 ? (\n\t\t<EmptyState />\n\t) : (\n\t\t<>\n\t\t\t{ids.map((id) => (\n\t\t\t\t<CategoryButton\n\t\t\t\t\tkey={id}\n\t\t\t\t\tid={id}\n\t\t\t\t\tlabelPrefix={prefix}\n\t\t\t\t/>\n\t\t\t))}\n\t\t</>\n\t);\n\nconst SidebarUniqueSection: React.FC<{\n\tdocId: TDocId;\n\tids: THighlightId[];\n}> = ({ docId, ids }) => {\n\tconst themeColor = DOC_THEME_COLORS[docId] || \"#ccc\";\n\t// USE LOOKUP for Label\n\tconst formattedLabel = `Unique to ${DOC_LOOKUP[docId].label}`;\n\n\treturn (\n\t\t<div style={SidebarSectionStyle}>\n\t\t\t<SectionHeader\n\t\t\t\tlabel={formattedLabel}\n\t\t\t\tcolor={themeColor}\n\t\t\t/>\n\t\t\t<AttributeList\n\t\t\t\tids={ids}\n\t\t\t\tprefix=\"Unique\"\n\t\t\t/>\n\t\t</div>\n\t);\n};\n\nconst UniqueAttrsSidebar: React.FC = () => {\n\tconst { uniqueMap } = useDataCategorization();\n\tconst { selectedDocs } = useAnalysisContext();\n\n\tif (selectedDocs.length === 0) {\n\t\treturn (\n\t\t\t<div style={SidebarStyle}>\n\t\t\t\t<EmptyState message=\"No documents selected\" />\n\t\t\t</div>\n\t\t);\n\t}\n\n\treturn (\n\t\t<div style={SidebarStyle}>\n\t\t\t{Object.entries(uniqueMap).map(([docId, ids]) => (\n\t\t\t\t<SidebarUniqueSection\n\t\t\t\t\tkey={docId}\n\t\t\t\t\tdocId={docId}\n\t\t\t\t\tids={ids}\n\t\t\t\t/>\n\t\t\t))}\n\t\t</div>\n\t);\n};\n\nconst SharedAttrsFooter: React.FC = () => {\n\tconst { sharedList } = useDataCategorization();\n\tconst { selectedDocs } = useAnalysisContext();\n\n\tif (selectedDocs.length === 0) return null;\n\n\treturn (\n\t\t<div style={SharedFooterStyle}>\n\t\t\t<SectionHeader\n\t\t\t\tlabel=\"Shared Observations\"\n\t\t\t\tcolor=\"#2563eb\"\n\t\t\t/>\n\t\t\t<div style={SharedItemsWrapperStyle}>\n\t\t\t\t{sharedList.length > 0 ? (\n\t\t\t\t\tsharedList.map((id) => (\n\t\t\t\t\t\t<CategoryButton\n\t\t\t\t\t\t\tkey={id}\n\t\t\t\t\t\t\tid={id}\n\t\t\t\t\t\t\tlabelPrefix=\"Shared\"\n\t\t\t\t\t\t\tStyleOverrides={SharedCategoryButtonStyle}\n\t\t\t\t\t\t/>\n\t\t\t\t\t))\n\t\t\t\t) : (\n\t\t\t\t\t<EmptyState message=\"No shared attributes found.\" />\n\t\t\t\t)}\n\t\t\t</div>\n\t\t</div>\n\t);\n};\n\nconst DropdownItemList: React.FC = () => {\n\tconst { selectedDocs, toggleDoc } = useAnalysisContext();\n\t// Iterate LOOKUP keys for flat list\n\treturn (\n\t\t<div style={DropdownMenuStyle}>\n\t\t\t{Object.keys(DOC_LOOKUP).map((docId) => {\n\t\t\t\tconst isSelected = selectedDocs.includes(docId);\n\t\t\t\treturn (\n\t\t\t\t\t<div\n\t\t\t\t\t\tkey={docId}\n\t\t\t\t\t\tstyle={dropdownItemStyle(isSelected)}\n\t\t\t\t\t\tonClick={() => toggleDoc(docId)}\n\t\t\t\t\t>\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\ttype=\"checkbox\"\n\t\t\t\t\t\t\tchecked={isSelected}\n\t\t\t\t\t\t\treadOnly\n\t\t\t\t\t\t\tstyle={{ pointerEvents: \"none\" }}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t{/* USE LOOKUP for Label */}\n\t\t\t\t\t\t{DOC_LOOKUP[docId].label}\n\t\t\t\t\t</div>\n\t\t\t\t);\n\t\t\t})}\n\t\t</div>\n\t);\n};\n\nconst DocumentSelectorDropdown: React.FC = () => {\n\tconst { selectedDocs, isDropdownOpen, setIsDropdownOpen } =\n\t\tuseAnalysisContext();\n\tconst dropdownRef = useDropdownBehavior(isDropdownOpen, setIsDropdownOpen);\n\n\treturn (\n\t\t<div\n\t\t\tstyle={DropdownWrapperStyle}\n\t\t\tref={dropdownRef}\n\t\t>\n\t\t\t<button\n\t\t\t\tstyle={SelectorButtonStyle}\n\t\t\t\tonClick={() => setIsDropdownOpen(!isDropdownOpen)}\n\t\t\t>\n\t\t\t\t<span>\n\t\t\t\t\t{selectedDocs.length === 0\n\t\t\t\t\t\t? \"Select...\"\n\t\t\t\t\t\t: `${selectedDocs.length} Selected`}\n\t\t\t\t</span>\n\t\t\t\t<span style={{ fontSize: \"10px\" }}>â–¼</span>\n\t\t\t</button>\n\n\t\t\t{isDropdownOpen && <DropdownItemList />}\n\t\t</div>\n\t);\n};\n\nconst AnalysisTopBar: React.FC = () => {\n\tconst { setActiveIds } = useAnalysisContext();\n\treturn (\n\t\t<div style={TopControlBarStyle}>\n\t\t\t<label style={{ fontWeight: \"bold\", fontSize: \"14px\" }}>\n\t\t\t\tSelect Documents:\n\t\t\t</label>\n\t\t\t<DocumentSelectorDropdown />\n\t\t\t<button\n\t\t\t\tonClick={() => setActiveIds([])}\n\t\t\t\tstyle={ClearButtonStyle}\n\t\t\t>\n\t\t\t\tClear Highlights\n\t\t\t</button>\n\t\t</div>\n\t);\n};\n\nconst DocumentColumn: React.FC<{ docId: TDocId }> = ({ docId }) => {\n\t// USE LOOKUP for Content\n\tconst content = DOC_LOOKUP[docId].content;\n\n\tconst segments = useMemo(() => flattenRanges(docId, RAW_ANALYSIS), [docId]);\n\tconst themeColor = DOC_THEME_COLORS[docId] || \"#ccc\";\n\n\tconst scrollRef = useRef<HTMLDivElement>(null);\n\t// This hook triggers re-renders when context changes\n\tuseAutoScroll(scrollRef as any);\n\n\treturn (\n\t\t<div style={DocColumnWrapperStyle}>\n\t\t\t<div style={getDocHeaderStyle(themeColor)}>\n\t\t\t\t{DOC_LOOKUP[docId].label}\n\t\t\t</div>\n\t\t\t<div\n\t\t\t\tstyle={DocScrollStyle}\n\t\t\t\tref={scrollRef}\n\t\t\t>\n\t\t\t\t{/* 2. Use the memoized component here */}\n\t\t\t\t<MarkdownViewer\n\t\t\t\t\tcontent={content}\n\t\t\t\t\tsegments={segments}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t);\n};\n\nconst DocumentGrid: React.FC = () => {\n\tconst { selectedDocs } = useAnalysisContext();\n\n\tif (selectedDocs.length === 0) {\n\t\treturn (\n\t\t\t<div style={DocGridContainerStyle}>\n\t\t\t\t<div style={EmptyGridMessageStyle}>\n\t\t\t\t\tPlease select a document.\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n\n\treturn (\n\t\t<div style={DocGridContainerStyle}>\n\t\t\t{selectedDocs.map((docId) => (\n\t\t\t\t<DocumentColumn\n\t\t\t\t\tkey={docId}\n\t\t\t\t\tdocId={docId}\n\t\t\t\t/>\n\t\t\t))}\n\t\t</div>\n\t);\n};\n\nconst AnalysisStyler: React.FC = () => <style>{useDynamicStyles()}</style>;\n\nconst DocumentAnalysisViewer: React.FC = () => (\n\t<AnalysisCTX value={useAnalysisState()}>\n\t\t<AnalysisStyler />\n\t\t<div\n\t\t\tstyle={MainContainerStyle}\n\t\t\tclassName=\"no-aos\"\n\t\t>\n\t\t\t<AnalysisTopBar />\n\n\t\t\t<div style={ContentAreaStyle}>\n\t\t\t\t<UniqueAttrsSidebar />\n\n\t\t\t\t<div style={MainContentColumnStyle}>\n\t\t\t\t\t<DocumentGrid />\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<SharedAttrsFooter />\n\t\t</div>\n\t</AnalysisCTX>\n);\n\nexport { DocumentAnalysisViewer };\n","import { DocumentAnalysisViewer } from \"./CSS_Markdown/CSSMarkdown\";\nconst F = () => <DocumentAnalysisViewer />;\nexport default F;\n"],"names":["toCssClass","id","concat","replace","remarkHighlightPlugin","options","tree","segments","length","visit","node","index","parent","undefined","position","textNode","nodeStart","start","offset","nodeEnd","end","relevantSegments","filter","s","newChildren","cursor","seg","sort","a","b","push","type","value","slice","hStart","Math","max","hEnd","min","textContent","classNames","ids","map","join","data","hName","hProperties","className","children","splice","MarkdownViewer","React","_ref","content","_jsx","ReactMarkdown","remarkPlugins","remarkGfm","components","highlight","_ref2","props","_objectWithoutProperties","_excluded","_objectSpread","MainContainerStyle","display","flexDirection","fontFamily","width","maxWidth","margin","height","border","borderRadius","overflow","backgroundColor","TopControlBarStyle","padding","borderBottom","alignItems","gap","zIndex","ContentAreaStyle","SidebarStyle","minWidth","borderRight","overflowY","MainContentColumnStyle","flex","DocGridContainerStyle","SharedFooterStyle","borderTop","SectionHeaderStyle","fontSize","textTransform","color","fontWeight","marginBottom","letterSpacing","ButtonStyle","textAlign","lineHeight","transition","DropdownWrapperStyle","DropdownMenuStyle","top","left","marginTop","boxShadow","DropdownItemBaseStyle","userSelect","dropdownItemStyle","isSelected","SelectorButtonStyle","justifyContent","ClearButtonStyle","marginLeft","background","EmptyStateStyle","SidebarSectionStyle","SharedItemsWrapperStyle","flexWrap","SharedCategoryButtonStyle","EmptyGridMessageStyle","DocColumnWrapperStyle","borderLeft","DocScrollStyle","whiteSpace","categoryButtonStyle","isActive","StyleOverrides","arguments","RAW_DOCS","RAW_ANALYSIS","local_question_data","DOC_LOOKUP","Object","entries","forEach","policyName","versions","hash","policy_content","label","fetch_date","ANALYSIS_KEYS","keys","GRADIENT_COLORS","generateGradient","ID_COLORS","key","DOC_HASHES","DOC_COLORS_LIST","DOC_THEME_COLORS","AnalysisCTX","createContext","useAnalysisState","activeIds","setActiveIds","useState","selectedDocs","setSelectedDocs","isDropdownOpen","setIsDropdownOpen","scrollToId","setScrollToId","toggleDoc","docId","prev","includes","d","toggleId","isTurningOn","x","setTimeout","useAnalysisContext","context","useContext","Error","useDataCategorization","useMemo","qTypes","_ref4","questionId","docMap","Set","size","visibleUniqueMap","visibleSharedList","_ref5","docKeys","some","docHash","uniqueMap","sharedList","useDynamicStyles","highlightRules","dynamicHighlightStyles","colorMap","rules","borderColor","safeClassName","styleObjectToString","CategoryButton","labelPrefix","_jsxs","onClick","style","toUpperCase","SectionHeader","paddingBottom","EmptyState","_ref3","message","AttributeList","prefix","_Fragment","SidebarUniqueSection","themeColor","formattedLabel","UniqueAttrsSidebar","_ref6","SharedAttrsFooter","DropdownItemList","checked","readOnly","pointerEvents","DocumentSelectorDropdown","isOpen","setIsOpen","ref","dropdownRef","useRef","useEffect","handleClickOutside","event","current","contains","target","document","addEventListener","removeEventListener","AnalysisTopBar","DocumentColumn","_ref7","flattenRanges","points","rangeMap","occurrences","instance","substring_indices","add","sortedPoints","Array","from","_loop","i","mid","r","scrollRef","containerRef","container","querySelector","containerRect","getBoundingClientRect","targetRect","relativeTop","scrollPos","scrollTop","scrollTo","behavior","useAutoScroll","DocumentGrid","AnalysisStyler","DocumentAnalysisViewer","F"],"ignoreList":[],"sourceRoot":""}